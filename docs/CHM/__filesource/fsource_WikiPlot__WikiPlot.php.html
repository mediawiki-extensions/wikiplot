<!--
	IE 6 makes the page to wide with the following doctype. I accept
	standards if they help me, not if they make anything even harder!
//-->
<!--<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.0 Transitional//EN' 'http://www.w3.org/TR/REC-html40/loose.dtd'>//-->
<!--NewPage-->
<HTML>
<HEAD>
	<!-- Generated by PhpDoc date: 'Fri, 13 Oct 2006 06:44:40 +0200' -->
	<TITLE>File Source for WikiPlot.php</TITLE>
<LINK REL ='stylesheet' TYPE='text/css' HREF='../media/stylesheet.css' TITLE='Style'>
</HEAD>
<BODY BGCOLOR='white'>
<a name="top"><!-- --></a><h1 align="center">Source for file WikiPlot.php</h1>
<p>Documentation is available at <a href="../WikiPlot/_WikiPlot_php.html">WikiPlot.php</a></p>
<pre><a name="a1"></a><br />1     <strong>&lt;?php</strong><a name="a2"></a><br />2     <font color="green">/*</font><a name="a3"></a><br />3     <font color="green">Copyright (C) 2006 by the WikiPlot project authors (See http://code.google.com/p/WikiPlot).</font><a name="a4"></a><br />4     <a name="a5"></a><br />5     <font color="green">This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.</font><a name="a6"></a><br />6     <a name="a7"></a><br />7     <font color="green">This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</font><a name="a8"></a><br />8     <a name="a9"></a><br />9     <font color="green">You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA</font><a name="a10"></a><br />10    <font color="green">*/</font><a name="a11"></a><br />11    <a name="a12"></a><br />12    <font color="#009999">/**</font><a name="a13"></a><br />13    <font color="#009999">* The MediaWiki extension</font><a name="a14"></a><br />14    <font color="#009999">*</font><a name="a15"></a><br />15    <font color="#009999">* This is the MediaWiki extension it self, everything else is just functions and liberaries for this file.</font><a name="a16"></a><br />16    <font color="#009999">*</font><a name="a17"></a><br />17    <font color="#009999">* </font><strong><font color = "#0099FF">@package</font></strong><font color="#009999"> WikiPlot</font><a name="a18"></a><br />18    <font color="#009999">* </font><strong><font color = "#0099FF">@license</font></strong><font color="#009999"> http://www.gnu.org/licenses/gpl.txt GNU General Public License</font><a name="a19"></a><br />19    <font color="#009999">* </font><strong><font color = "#0099FF">@author</font></strong><font color="#009999"> WikiPlot development team.</font><a name="a20"></a><br />20    <font color="#009999">* </font><strong><font color = "#0099FF">@copyright</font></strong><font color="#009999"> Copyright 2006, WikiPlot development team.</font><a name="a21"></a><br />21    <font color="#009999">*/</font><a name="a22"></a><br />22    <a name="a23"></a><br />23    <a name="a24"></a><br />24    <font color="#009999">/**</font><a name="a25"></a><br />25    <font color="#009999">*Include plot.class.php</font><a name="a26"></a><br />26    <font color="#009999">*</font><a name="a27"></a><br />27    <font color="#009999">*Requires PlotClass to render plots.</font><a name="a28"></a><br />28    <font color="#009999">*/</font><a name="a29"></a><br />29    <font color="blue">require_once</font><strong>(</strong><font color="#66cccc">&quot;PlotClass/plot.class.php&quot;</font><strong>)</strong><strong>;</strong><a name="a30"></a><br />30    <a name="a31"></a><br />31    <font color="#009999">/**</font><a name="a32"></a><br />32    <font color="#009999">*Include xml.class.php</font><a name="a33"></a><br />33    <font color="#009999">*</font><a name="a34"></a><br />34    <font color="#009999">*Requires XMLParser to parse xml to plot.</font><a name="a35"></a><br />35    <font color="#009999">*/</font><a name="a36"></a><br />36    <font color="blue">require_once</font><strong>(</strong><font color="#66cccc">&quot;xml.class.php&quot;</font><strong>)</strong><strong>;</strong><a name="a37"></a><br />37    <a name="a38"></a><br />38    <font color="#009999">/**</font><a name="a39"></a><br />39    <font color="#009999">*Include cache.class.php</font><a name="a40"></a><br />40    <font color="#009999">*</font><a name="a41"></a><br />41    <font color="#009999">*Requires Cache to control the cache.</font><a name="a42"></a><br />42    <font color="#009999">*/</font><a name="a43"></a><br />43    <font color="blue">require_once</font><strong>(</strong><font color="#66cccc">&quot;cache.class.php&quot;</font><strong>)</strong><strong>;</strong><a name="a44"></a><br />44    <a name="a45"></a><br />45    <font color="#009999">/**</font><a name="a46"></a><br />46    <font color="#009999">*Register the WikiPlot extension</font><a name="a47"></a><br />47    <font color="#009999">*</font><a name="a48"></a><br />48    <font color="#009999">*Makes sure the extension is called when MediaWiki is started.</font><a name="a49"></a><br />49    <font color="#009999">*/</font><a name="a50"></a><br />50    <strong>$wgExtensionFunctions</strong><strong>[</strong><strong>] </strong>= <font color="#66cccc">&quot;wfWikiPlotExtension&quot;</font><strong>;</strong><a name="a51"></a><br />51    <a name="a52"></a><br />52    <font color="#009999">/**</font><a name="a53"></a><br />53    <font color="#009999">*Add hooks</font><a name="a54"></a><br />54    <font color="#009999">*</font><a name="a55"></a><br />55    <font color="#009999">*Adds hooks so MediaWiki will perform callback, when it hits the wikiplot tag.</font><a name="a56"></a><br />56    <font color="#009999">*/</font><a name="a57"></a><br />57    <font color="blue">function </font><a href="../WikiPlot/_WikiPlot_php.html#functionwfWikiPlotExtension">wfWikiPlotExtension</a><strong>(</strong><strong>) </strong><strong>{</strong><a name="a58"></a><br />58        <font color="blue">global </font><strong>$wgParser</strong><strong>;</strong><a name="a59"></a><br />59        <strong>$wgParser</strong><strong>-&gt;</strong>setHook<strong>( </strong><font color="#66cccc">&quot;wikiplot&quot;</font><strong>, </strong><font color="#66cccc">&quot;RenderWikiPlot&quot; </font><strong>)</strong><strong>;</strong><a name="a60"></a><br />60    <strong>}</strong><a name="a61"></a><br />61    <a name="a62"></a><br />62    <font color="#009999">/**</font><a name="a63"></a><br />63    <font color="#009999">*Deserialize boolean</font><a name="a64"></a><br />64    <font color="#009999">*</font><a name="a65"></a><br />65    <font color="#009999">*Deserializes a boolean value from string, this function is used when you want to deserialize parameters given in the WikiML.</font><a name="a66"></a><br />66    <font color="#009999">*If it is impossible to deserialize the value, the output object is not initialized at all.</font><a name="a67"></a><br />67    <font color="#009999">*</font><a name="a68"></a><br />68    <font color="#009999">*</font><strong><font color = "#0099FF">@access</font></strong><font color="#009999"> private</font><a name="a69"></a><br />69    <font color="#009999">*</font><strong><font color = "#0099FF">@param </font></strong><em>string </em><strong>$value </strong><font color="#009999">The string you wish to deserialize.</font><a name="a70"></a><br />70    <font color="#009999">*</font><strong><font color = "#0099FF">@param </font></strong><em>boolean </em><strong>&amp;$SetTo </strong><font color="#009999">The variable you want the values parsed to.</font><a name="a71"></a><br />71    <font color="#009999">*/</font><a name="a72"></a><br />72    <font color="blue">function </font><a href="../WikiPlot/_WikiPlot_php.html#functionWikiPlotDeserializeBoolean">WikiPlotDeserializeBoolean</a><strong>(</strong><strong>$value</strong><strong>,</strong><strong>&amp;</strong><strong>$SetTo</strong><strong>)</strong><a name="a73"></a><br />73    <strong>{</strong><a name="a74"></a><br />74        <font color="blue">if</font><strong>(</strong><strong>$value </strong>== <font color="#66cccc">&quot;true&quot;</font><strong>)</strong><a name="a75"></a><br />75        <strong>{</strong><a name="a76"></a><br />76            <strong>$SetTo </strong>= true<strong>;    </strong><a name="a77"></a><br />77        <strong>}</strong><a name="a78"></a><br />78        elseif<strong>(</strong><strong>$value </strong>== <font color="#66cccc">&quot;false&quot;</font><strong>)</strong><a name="a79"></a><br />79        <strong>{</strong><a name="a80"></a><br />80            <strong>$SetTo </strong>= false<strong>;</strong><a name="a81"></a><br />81        <strong>}</strong><a name="a82"></a><br />82    <strong>}</strong><a name="a83"></a><br />83    <a name="a84"></a><br />84    <font color="#009999">/**</font><a name="a85"></a><br />85    <font color="#009999">*Deserialize String</font><a name="a86"></a><br />86    <font color="#009999">*</font><a name="a87"></a><br />87    <font color="#009999">*Deserializes a string value from string, this function is used when you want to deserialize parameters given in the WikiML.</font><a name="a88"></a><br />88    <font color="#009999">*If it is impossible to deserialize the value, the output object is not initialized at all. Usualy this function does nothing.</font><a name="a89"></a><br />89    <font color="#009999">*</font><a name="a90"></a><br />90    <font color="#009999">*</font><strong><font color = "#0099FF">@access</font></strong><font color="#009999"> private</font><a name="a91"></a><br />91    <font color="#009999">*</font><strong><font color = "#0099FF">@param </font></strong><em>string </em><strong>$value </strong><font color="#009999">The string you wish to deserialize.</font><a name="a92"></a><br />92    <font color="#009999">*</font><strong><font color = "#0099FF">@param </font></strong><em>string </em><strong>&amp;$SetTo </strong><font color="#009999">The variable you want the values parsed to.</font><a name="a93"></a><br />93    <font color="#009999">*/</font><a name="a94"></a><br />94    <font color="blue">function </font><a href="../WikiPlot/_WikiPlot_php.html#functionWikiPlotDeserializeString">WikiPlotDeserializeString</a><strong>(</strong><strong>$value</strong><strong>,</strong><strong>&amp;</strong><strong>$SetTo</strong><strong>)</strong><a name="a95"></a><br />95    <strong>{</strong><a name="a96"></a><br />96        <font color="blue">if</font><strong>(</strong><a href="http://www.php.net/is_string">is_string</a><strong>(</strong><strong>$value</strong><strong>))</strong><a name="a97"></a><br />97        <strong>{</strong><a name="a98"></a><br />98            <strong>$SetTo </strong>= <strong>$value</strong><strong>;    </strong><a name="a99"></a><br />99        <strong>}</strong><a name="a100"></a><br />100       <a name="a101"></a><br />101   <strong>}</strong><a name="a102"></a><br />102   <a name="a103"></a><br />103   <font color="#009999">/**</font><a name="a104"></a><br />104   <font color="#009999">*Deserialize Coordiante</font><a name="a105"></a><br />105   <font color="#009999">*</font><a name="a106"></a><br />106   <font color="#009999">*Deserializes a 2 integers from string, this function is used when you want to deserialize parameters given in the WikiML.</font><a name="a107"></a><br />107   <font color="#009999">*If it is impossible to deserialize the value, the output object is not initialized at all.</font><a name="a108"></a><br />108   <font color="#009999">*</font><a name="a109"></a><br />109   <font color="#009999">*</font><strong><font color = "#0099FF">@access</font></strong><font color="#009999"> private</font><a name="a110"></a><br />110   <font color="#009999">*</font><strong><font color = "#0099FF">@param </font></strong><em>string </em><strong>$value </strong><font color="#009999">The string you wish to deserialize.</font><a name="a111"></a><br />111   <font color="#009999">*</font><strong><font color = "#0099FF">@param </font></strong><em>integer </em><strong>&amp;$SetTo1 </strong><font color="#009999">The variable you want the values parsed to.</font><a name="a112"></a><br />112   <font color="#009999">*</font><strong><font color = "#0099FF">@param </font></strong><em>integer </em><strong>&amp;$SetTo2 </strong><font color="#009999">The variable you want the values parsed to.</font><a name="a113"></a><br />113   <font color="#009999">*/</font><a name="a114"></a><br />114   <font color="blue">function </font><a href="../WikiPlot/_WikiPlot_php.html#functionWikiPlotDeserializeMixed">WikiPlotDeserializeMixed</a><strong>(</strong><strong>$value</strong><strong>,</strong><strong>&amp;</strong><strong>$SetTo1</strong><strong>,</strong><strong>&amp;</strong><strong>$SetTo2</strong><strong>)</strong><a name="a115"></a><br />115   <strong>{</strong><a name="a116"></a><br />116       <font color="blue">if</font><strong>(</strong><strong>!</strong><a href="http://www.php.net/is_null">is_null</a><strong>(</strong><strong>$value</strong><strong>))</strong><a name="a117"></a><br />117       <strong>{</strong><a name="a118"></a><br />118           <strong>$values </strong>= <a href="http://www.php.net/explode">explode</a><strong>(</strong><font color="#66cccc">&quot;;&quot;</font><strong>,</strong><strong>$value</strong><strong>,</strong>2<strong>)</strong><strong>;</strong><a name="a119"></a><br />119           <font color="blue">if</font><strong>(</strong><a href="http://www.php.net/is_numeric">is_numeric</a><strong>(</strong><strong>$values</strong><strong>[</strong>0<strong>]</strong><strong>)</strong>&amp;&amp;<a href="http://www.php.net/is_numeric">is_numeric</a><strong>(</strong><strong>$values</strong><strong>[</strong>1<strong>]</strong><strong>))</strong><a name="a120"></a><br />120           <strong>{</strong><a name="a121"></a><br />121               <strong>$SetTo1 </strong>= <strong>$values</strong><strong>[</strong>0<strong>]</strong><strong>;</strong><a name="a122"></a><br />122               <strong>$SetTo2 </strong>= <strong>$values</strong><strong>[</strong>1<strong>]</strong><strong>;</strong><a name="a123"></a><br />123           <strong>}</strong><a name="a124"></a><br />124       <strong>}</strong><a name="a125"></a><br />125   <strong>}</strong><a name="a126"></a><br />126   <a name="a127"></a><br />127   <font color="#009999">/**</font><a name="a128"></a><br />128   <font color="#009999">*Deserialize Integer</font><a name="a129"></a><br />129   <font color="#009999">*</font><a name="a130"></a><br />130   <font color="#009999">*Deserializes a integer value from string, this function is used when you want to deserialize parameters given in the WikiML.</font><a name="a131"></a><br />131   <font color="#009999">*If it is impossible to deserialize the value, the output object is not initialized at all. Usualy this function does nothing at all, just checks to see if the value can be parsed as an integer.</font><a name="a132"></a><br />132   <font color="#009999">*</font><a name="a133"></a><br />133   <font color="#009999">*</font><strong><font color = "#0099FF">@access</font></strong><font color="#009999"> private</font><a name="a134"></a><br />134   <font color="#009999">*</font><strong><font color = "#0099FF">@param </font></strong><em>string </em><strong>$value </strong><font color="#009999">The string you wish to deserialize.</font><a name="a135"></a><br />135   <font color="#009999">*</font><strong><font color = "#0099FF">@param </font></strong><em>Integer </em><strong>&amp;$SetTo </strong><font color="#009999">The variable you want the values parsed to.</font><a name="a136"></a><br />136   <font color="#009999">*/</font><a name="a137"></a><br />137   <font color="blue">function </font><a href="../WikiPlot/_WikiPlot_php.html#functionWikiPlotDeserializeInteger">WikiPlotDeserializeInteger</a><strong>(</strong><strong>$value</strong><strong>,</strong><strong>&amp;</strong><strong>$SetTo</strong><strong>)</strong><a name="a138"></a><br />138   <strong>{</strong><a name="a139"></a><br />139       <font color="blue">if</font><strong>(</strong><strong>!</strong><a href="http://www.php.net/is_null">is_null</a><strong>(</strong><strong>$value</strong><strong>))</strong><a name="a140"></a><br />140       <strong>{</strong><a name="a141"></a><br />141           <font color="blue">if</font><strong>(</strong><a href="http://www.php.net/is_numeric">is_numeric</a><strong>(</strong><strong>$value</strong><strong>))</strong><a name="a142"></a><br />142           <strong>{</strong><a name="a143"></a><br />143               <strong>$SetTo </strong>= <strong>$value</strong><strong>;</strong><a name="a144"></a><br />144           <strong>}</strong><a name="a145"></a><br />145       <strong>}</strong><a name="a146"></a><br />146   <strong>}</strong><a name="a147"></a><br />147   <a name="a148"></a><br />148   <font color="#009999">/**</font><a name="a149"></a><br />149   <font color="#009999">*Deserialize Color</font><a name="a150"></a><br />150   <font color="#009999">*</font><a name="a151"></a><br />151   <font color="#009999">*Deserializes an array representation of a rgb color from string, this function is used when you want to deserialize parameters given in the WikiML.</font><a name="a152"></a><br />152   <font color="#009999">*This function can deserialize colors written as &quot;255,255,255&quot; (rgb) or &quot;#000000&quot; (hex).</font><a name="a153"></a><br />153   <font color="#009999">*If it is impossible to deserialize the value, the output object is not initialized at all.</font><a name="a154"></a><br />154   <font color="#009999">*</font><a name="a155"></a><br />155   <font color="#009999">*</font><strong><font color = "#0099FF">@access</font></strong><font color="#009999"> private</font><a name="a156"></a><br />156   <font color="#009999">*</font><strong><font color = "#0099FF">@param </font></strong><em>string </em><strong>$value </strong><font color="#009999">The string you wish to deserialize.</font><a name="a157"></a><br />157   <font color="#009999">*</font><strong><font color = "#0099FF">@param </font></strong><em>array </em><strong>&amp;$SetTo </strong><font color="#009999">The variable you want the values parsed to.</font><a name="a158"></a><br />158   <font color="#009999">*/</font><a name="a159"></a><br />159   <font color="blue">function </font><a href="../WikiPlot/_WikiPlot_php.html#functionWikiPlotDeserializeColor">WikiPlotDeserializeColor</a><strong>(</strong><strong>$value</strong><strong>,</strong><strong>&amp;</strong><strong>$SetTo</strong><strong>)</strong><a name="a160"></a><br />160   <strong>{</strong><a name="a161"></a><br />161       <font color="blue">if</font><strong>(</strong><strong>!</strong><a href="http://www.php.net/is_null">is_null</a><strong>(</strong><strong>$value</strong><strong>))</strong><a name="a162"></a><br />162       <strong>{</strong><a name="a163"></a><br />163           <strong>$values </strong>= <a href="http://www.php.net/explode">explode</a><strong>(</strong><font color="#66cccc">&quot;,&quot;</font><strong>,</strong><strong>$value</strong><strong>,</strong>3<strong>)</strong><strong>;</strong><a name="a164"></a><br />164           <font color="blue">if</font><strong>(</strong><a href="http://www.php.net/is_numeric">is_numeric</a><strong>(</strong><strong>$values</strong><strong>[</strong>0<strong>]</strong><strong>)</strong>&amp;&amp;<a href="http://www.php.net/is_numeric">is_numeric</a><strong>(</strong><strong>$values</strong><strong>[</strong>1<strong>]</strong><strong>)</strong>&amp;&amp;<a href="http://www.php.net/is_numeric">is_numeric</a><strong>(</strong><strong>$values</strong><strong>[</strong>2<strong>]</strong><strong>))</strong><a name="a165"></a><br />165           <strong>{</strong><a name="a166"></a><br />166               <strong>$SetTo </strong>= array<strong>(</strong><strong>$values</strong><strong>[</strong>0<strong>]</strong><strong>,</strong><strong>$values</strong><strong>[</strong>1<strong>]</strong><strong>,</strong><strong>$values</strong><strong>[</strong>2<strong>]</strong><strong>)</strong><strong>;</strong><a name="a167"></a><br />167           <strong>}</strong><a name="a168"></a><br />168           elseif<strong>(</strong><a href="http://www.php.net/strstr">strstr</a><strong>(</strong><strong>$value</strong><strong>,</strong><font color="#66cccc">&quot;#&quot;</font><strong>))</strong><a name="a169"></a><br />169           <strong>{</strong><a name="a170"></a><br />170               <strong>$red </strong>= <a href="http://www.php.net/hexdec">hexdec</a><strong>(</strong><a href="http://www.php.net/substr">substr</a><strong>(</strong><strong>$val</strong><strong>, </strong>1 <strong>, </strong>2<strong>))</strong><strong>;</strong><a name="a171"></a><br />171               <strong>$green </strong>= <a href="http://www.php.net/hexdec">hexdec</a><strong>(</strong><a href="http://www.php.net/substr">substr</a><strong>(</strong><strong>$val</strong><strong>, </strong>3 <strong>, </strong>2<strong>))</strong><strong>;</strong><a name="a172"></a><br />172               <strong>$blue </strong>= <a href="http://www.php.net/hexdec">hexdec</a><strong>(</strong><a href="http://www.php.net/substr">substr</a><strong>(</strong><strong>$val</strong><strong>, </strong>5 <strong>, </strong>2<strong>))</strong><strong>;</strong><a name="a173"></a><br />173               <strong>$SetTo </strong>= array<strong>(</strong><strong>$red</strong><strong>,</strong><strong>$green</strong><strong>,</strong><strong>$blue</strong><strong>)</strong><strong>;</strong><a name="a174"></a><br />174           <strong>}</strong><a name="a175"></a><br />175       <strong>}</strong><a name="a176"></a><br />176   <strong>}</strong><a name="a177"></a><br />177   <a name="a178"></a><br />178   <font color="#009999">/**</font><a name="a179"></a><br />179   <font color="#009999">*RenderWikiPlot CallBack function</font><a name="a180"></a><br />180   <font color="#009999">*</font><a name="a181"></a><br />181   <font color="#009999">*This is the function that handles MediaWiki callbacks, and renders the actual plot.</font><a name="a182"></a><br />182   <font color="#009999">*</font><a name="a183"></a><br />183   <font color="#009999">*</font><strong><font color = "#0099FF">@access</font></strong><font color="#009999"> private</font><a name="a184"></a><br />184   <font color="#009999">*</font><strong><font color = "#0099FF">@param </font></strong><em>string </em><strong>$input </strong><font color="#009999">The content of the wikiplot tag</font><a name="a185"></a><br />185   <font color="#009999">*</font><strong><font color = "#0099FF">@param </font></strong><em>array </em><strong>$argv </strong><font color="#009999">Hash-array of the parameters of the wikiplot tag, with parameter-name as key and parameter-value as value.</font><a name="a186"></a><br />186   <font color="#009999">*</font><strong><font color = "#0099FF">@param </font></strong><em>Parser </em><strong>$parser </strong><font color="#009999">The parser of MediaWiki, if null parser is obtained from global variable</font><a name="a187"></a><br />187   <font color="#009999">*</font><strong><font color = "#0099FF">@uses</font></strong><font color="#009999"> WikiPlotDeserializeBoolean()</font><a name="a188"></a><br />188   <font color="#009999">*</font><strong><font color = "#0099FF">@uses</font></strong><font color="#009999"> WikiPlotDeserializeString()</font><a name="a189"></a><br />189   <font color="#009999">*</font><strong><font color = "#0099FF">@uses</font></strong><font color="#009999"> WikiPlotDeserializeMixed()</font><a name="a190"></a><br />190   <font color="#009999">*</font><strong><font color = "#0099FF">@uses</font></strong><font color="#009999"> WikiPlotDeserializeInteger()</font><a name="a191"></a><br />191   <font color="#009999">*</font><strong><font color = "#0099FF">@uses</font></strong><font color="#009999"> WikiPlotDeserializeColor()</font><a name="a192"></a><br />192   <font color="#009999">*</font><strong><font color = "#0099FF">@uses</font></strong><font color="#009999"> XMLParser</font><a name="a193"></a><br />193   <font color="#009999">*</font><strong><font color = "#0099FF">@uses</font></strong><font color="#009999"> Plot</font><a name="a194"></a><br />194   <font color="#009999">*</font><strong><font color = "#0099FF">@uses</font></strong><font color="#009999"> Graph</font><a name="a195"></a><br />195   <font color="#009999">*</font><strong><font color = "#0099FF">@uses</font></strong><font color="#009999"> Cache</font><a name="a196"></a><br />196   <font color="#009999">*</font><strong><font color = "#0099FF">@return </font></strong><em>string </em><font color="#009999">HTML that can be directly inserted into any website.</font><a name="a197"></a><br />197   <font color="#009999">*/</font><a name="a198"></a><br />198   <font color="blue">function </font><a href="../WikiPlot/_WikiPlot_php.html#functionRenderWikiPlot">RenderWikiPlot</a><strong>(</strong><strong>$input</strong><strong>, </strong><strong>$argv</strong><strong>, </strong><strong>$parser </strong>= null<strong>)</strong><a name="a199"></a><br />199   <strong>{</strong><a name="a200"></a><br />200       <font color="green">//Get parser if not given as parameter</font><a name="a201"></a><br />201       <font color="blue">if </font><strong>(</strong><strong>!</strong><strong>$parser</strong><strong>) </strong><strong>$parser </strong>=<strong>&amp; </strong><strong>$GLOBALS</strong><strong>[</strong><font color="#66cccc">'wgParser'</font><strong>]</strong><strong>;</strong><a name="a202"></a><br />202       <font color="green">/*Currently the parser*/</font><a name="a203"></a><br />203   <a name="a204"></a><br />204       <font color="green">//Creating instance of plot</font><a name="a205"></a><br />205       <strong>$Plot </strong>= new <a href="../WikiPlot/PlotClass/Plot.html">Plot</a><strong>(</strong><strong>)</strong><strong>;</strong><a name="a206"></a><br />206   <a name="a207"></a><br />207       <font color="green">//Getting and deserializing parameters</font><a name="a208"></a><br />208       <a href="../WikiPlot/_WikiPlot_php.html#functionWikiPlotDeserializeBoolean">WikiPlotDeserializeBoolean</a><strong>(</strong><strong>$argv</strong><strong>[</strong><font color="#66cccc">&quot;grid&quot;</font><strong>]</strong><strong>,</strong><strong>$Plot</strong><strong>-&gt;</strong>EnableGrid<strong>)</strong><strong>;</strong><a name="a209"></a><br />209       <a href="../WikiPlot/_WikiPlot_php.html#functionWikiPlotDeserializeBoolean">WikiPlotDeserializeBoolean</a><strong>(</strong><strong>$argv</strong><strong>[</strong><font color="#66cccc">&quot;axis&quot;</font><strong>]</strong><strong>,</strong><strong>$Plot</strong><strong>-&gt;</strong>EnableAxis<strong>)</strong><strong>;</strong><a name="a210"></a><br />210   <a name="a211"></a><br />211       <a href="../WikiPlot/_WikiPlot_php.html#functionWikiPlotDeserializeString">WikiPlotDeserializeString</a><strong>(</strong><strong>$argv</strong><strong>[</strong><font color="#66cccc">&quot;caption&quot;</font><strong>]</strong><strong>,</strong><strong>$Plot</strong><strong>-&gt;</strong>Caption<strong>)</strong><strong>;</strong><a name="a212"></a><br />212   <a name="a213"></a><br />213       <a href="../WikiPlot/_WikiPlot_php.html#functionWikiPlotDeserializeMixed">WikiPlotDeserializeMixed</a><strong>(</strong><strong>$argv</strong><strong>[</strong><font color="#66cccc">&quot;xspan&quot;</font><strong>]</strong><strong>,</strong><strong>$Plot</strong><strong>-&gt;</strong>MinX<strong>,</strong><strong>$Plot</strong><strong>-&gt;</strong>MaxX<strong>)</strong><strong>;</strong><a name="a214"></a><br />214       <a href="../WikiPlot/_WikiPlot_php.html#functionWikiPlotDeserializeMixed">WikiPlotDeserializeMixed</a><strong>(</strong><strong>$argv</strong><strong>[</strong><font color="#66cccc">&quot;yspan&quot;</font><strong>]</strong><strong>,</strong><strong>$Plot</strong><strong>-&gt;</strong>MinY<strong>,</strong><strong>$Plot</strong><strong>-&gt;</strong>MaxY<strong>)</strong><strong>;</strong><a name="a215"></a><br />215       <a href="../WikiPlot/_WikiPlot_php.html#functionWikiPlotDeserializeMixed">WikiPlotDeserializeMixed</a><strong>(</strong><strong>$argv</strong><strong>[</strong><font color="#66cccc">&quot;gridspace&quot;</font><strong>]</strong><strong>,</strong><strong>$Plot</strong><strong>-&gt;</strong>XGridSpace<strong>,</strong><strong>$Plot</strong><strong>-&gt;</strong>YGridSpace<strong>)</strong><strong>;</strong><a name="a216"></a><br />216   <a name="a217"></a><br />217       <a href="../WikiPlot/_WikiPlot_php.html#functionWikiPlotDeserializeInteger">WikiPlotDeserializeInteger</a><strong>(</strong><strong>$argv</strong><strong>[</strong><font color="#66cccc">&quot;height&quot;</font><strong>]</strong><strong>,</strong><strong>$Plot</strong><strong>-&gt;</strong>Height<strong>)</strong><strong>;</strong><a name="a218"></a><br />218       <a href="../WikiPlot/_WikiPlot_php.html#functionWikiPlotDeserializeInteger">WikiPlotDeserializeInteger</a><strong>(</strong><strong>$argv</strong><strong>[</strong><font color="#66cccc">&quot;width&quot;</font><strong>]</strong><strong>,</strong><strong>$Plot</strong><strong>-&gt;</strong>Width<strong>)</strong><strong>;</strong><a name="a219"></a><br />219       <a href="../WikiPlot/_WikiPlot_php.html#functionWikiPlotDeserializeInteger">WikiPlotDeserializeInteger</a><strong>(</strong><strong>$argv</strong><strong>[</strong><font color="#66cccc">&quot;captionfont&quot;</font><strong>]</strong><strong>,</strong><strong>$Plot</strong><strong>-&gt;</strong>CaptionFont<strong>)</strong><strong>;</strong><a name="a220"></a><br />220       <a href="../WikiPlot/_WikiPlot_php.html#functionWikiPlotDeserializeInteger">WikiPlotDeserializeInteger</a><strong>(</strong><strong>$argv</strong><strong>[</strong><font color="#66cccc">&quot;gridfont&quot;</font><strong>]</strong><strong>,</strong><strong>$Plot</strong><strong>-&gt;</strong>GridFont<strong>)</strong><strong>;</strong><a name="a221"></a><br />221   <a name="a222"></a><br />222       <a href="../WikiPlot/_WikiPlot_php.html#functionWikiPlotDeserializeColor">WikiPlotDeserializeColor</a><strong>(</strong><strong>$argv</strong><strong>[</strong><font color="#66cccc">&quot;gridcolor&quot;</font><strong>]</strong><strong>,</strong><strong>$Plot</strong><strong>-&gt;</strong>GridColor<strong>)</strong><strong>;</strong><a name="a223"></a><br />223   <a name="a224"></a><br />224       <font color="green">//Parsing Xml</font><a name="a225"></a><br />225       <strong>$XmlParser </strong>= new <a href="../WikiPlot/XMLParser.html">XMLParser</a><strong>(</strong><strong>$input</strong><strong>)</strong><strong>;</strong><a name="a226"></a><br />226       <strong>$Graphs </strong>= <strong>$XmlParser</strong><strong>-&gt;</strong>CreateInputArray<strong>(</strong><strong>)</strong><strong>;</strong><a name="a227"></a><br />227   <a name="a228"></a><br />228       <font color="blue">foreach</font><strong>(</strong><strong>$Graphs </strong>as <strong>$Graph</strong><strong>)</strong><a name="a229"></a><br />229       <strong>{</strong><a name="a230"></a><br />230           <strong>$G </strong>= new <a href="../WikiPlot/PlotClass/Graph.html">Graph</a><strong>;</strong><a name="a231"></a><br />231           <font color="blue">if</font><strong>(</strong><strong>!</strong><a href="http://www.php.net/is_array">is_array</a><strong>(</strong><strong>$Graph</strong><strong>[</strong>1<strong>]</strong><strong>))</strong><a name="a232"></a><br />232           <strong>{</strong><a name="a233"></a><br />233               <strong>$G</strong><strong>-&gt;</strong>Exp = <strong>$Graph</strong><strong>[</strong>1<strong>]</strong><strong>;</strong><a name="a234"></a><br />234               <a href="../WikiPlot/_WikiPlot_php.html#functionWikiPlotDeserializeString">WikiPlotDeserializeString</a><strong>(</strong><strong>$Graph</strong><strong>[</strong>0<strong>]</strong><strong>[</strong><font color="#66cccc">&quot;label&quot;</font><strong>]</strong><strong>,</strong><strong>$G</strong><strong>-&gt;</strong>Label<strong>)</strong><strong>;</strong><a name="a235"></a><br />235               <a href="../WikiPlot/_WikiPlot_php.html#functionWikiPlotDeserializeColor">WikiPlotDeserializeColor</a><strong>(</strong><strong>$Graph</strong><strong>[</strong>0<strong>]</strong><strong>[</strong><font color="#66cccc">&quot;color&quot;</font><strong>]</strong><strong>,</strong><strong>$G</strong><strong>-&gt;</strong>Color<strong>)</strong><strong>;</strong><a name="a236"></a><br />236           <strong>}</strong>else<strong>{</strong><a name="a237"></a><br />237               <strong>$G</strong><strong>-&gt;</strong>Exp = <strong>$Graph</strong><strong>[</strong>0<strong>]</strong><strong>;</strong><a name="a238"></a><br />238           <strong>}</strong><a name="a239"></a><br />239           <a href="http://www.php.net/array_push">array_push</a><strong>(</strong><strong>$Plot</strong><strong>-&gt;</strong>Graphs<strong>,</strong><strong>$G</strong><strong>)</strong><strong>;</strong><a name="a240"></a><br />240       <strong>}</strong><a name="a241"></a><br />241   <a name="a242"></a><br />242       <font color="green">//Render the plot</font><a name="a243"></a><br />243   <a name="a244"></a><br />244       <font color="green">//Get instance of cache</font><a name="a245"></a><br />245       <strong>$cache </strong>= new cache<strong>(</strong><strong>)</strong><strong>;</strong><a name="a246"></a><br />246       <a name="a247"></a><br />247       <font color="green">//Url of the current plot</font><a name="a248"></a><br />248       <strong>$PlotURL </strong>= <font color="#66cccc">&quot;&quot;</font><strong>;</strong><a name="a249"></a><br />249   <a name="a250"></a><br />250       <strong>$PlotFileName </strong>= <strong>$Plot</strong><strong>-&gt;</strong>GetHash<strong>(</strong><strong>) </strong>. <font color="#66cccc">&quot;.png&quot;</font><strong>;</strong><a name="a251"></a><br />251       <font color="blue">if</font><strong>(</strong><strong>!</strong><strong>$cache</strong><strong>-&gt;</strong>FileExist<strong>(</strong><strong>$PlotFileName</strong><strong>))</strong><a name="a252"></a><br />252       <strong>{</strong><a name="a253"></a><br />253           <strong>$Plot</strong><strong>-&gt;</strong>SaveAs<strong>(</strong><strong>$cache</strong><strong>-&gt;</strong>CachePath<strong>(</strong><strong>$PlotFileName</strong><strong>))</strong><strong>;</strong><a name="a254"></a><br />254       <strong>}</strong>else<strong>{</strong><a name="a255"></a><br />255           <strong>$PlotURL </strong>= <strong>$cache</strong><strong>-&gt;</strong>FileURL<strong>(</strong><strong>$PlotFileName</strong><strong>)</strong><strong>;</strong><a name="a256"></a><br />256       <strong>}</strong><a name="a257"></a><br />257   <a name="a258"></a><br />258       <strong>$output </strong>= <font color="#66cccc">&quot;</font><font color="#66cccc">&lt;a href='<strong>$PlotURL</strong>' class='image' title='See the plot'&gt;&lt;img src='<strong>$PlotURL</strong>'&gt;&lt;/a&gt;</font><font color="#66cccc">&quot;</font><strong>;</strong><a name="a259"></a><br />259   <a name="a260"></a><br />260       <font color="blue">return </font><strong>$output</strong><strong>;</strong><a name="a261"></a><br />261   <strong>}</strong><a name="a262"></a><br />262   <a name="a263"></a><br />263   <strong>?&gt;</strong></pre>
	<div id="credit">
		<hr>
		Documentation generated on Fri, 13 Oct 2006 06:44:40 +0200 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.3.0RC3</a>
	</div>
</body>
</html>