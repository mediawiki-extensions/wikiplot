<!--
	IE 6 makes the page to wide with the following doctype. I accept
	standards if they help me, not if they make anything even harder!
//-->
<!--<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.0 Transitional//EN' 'http://www.w3.org/TR/REC-html40/loose.dtd'>//-->
<!--NewPage-->
<HTML>
<HEAD>
	<!-- Generated by PhpDoc date: 'Fri, 13 Oct 2006 06:44:29 +0200' -->
	<TITLE>File Source for evalmath.class.php</TITLE>
<LINK REL ='stylesheet' TYPE='text/css' HREF='../media/stylesheet.css' TITLE='Style'>
</HEAD>
<BODY BGCOLOR='white'>
<a name="top"><!-- --></a><h1 align="center">Source for file evalmath.class.php</h1>
<p>Documentation is available at <a href="../WikiPlot/PlotClass/_PlotClass_evalmath_class_php.html">evalmath.class.php</a></p>
<pre><a name="a1"></a><br />1     <strong>&lt;?</strong><a name="a2"></a><br />2     <font color="#009999">/**</font><a name="a3"></a><br />3     <font color="#009999">* File containing EvalMath and EvalMathStack classes</font><a name="a4"></a><br />4     <font color="#009999">* </font><a name="a5"></a><br />5     <font color="#009999">* EvalMath class is used to evaluate math expressions safely, while the EvalMathStack</font><a name="a6"></a><br />6     <font color="#009999">* class is used by EvalMath.</font><a name="a7"></a><br />7     <font color="#009999">* </font><a name="a8"></a><br />8     <font color="#009999">* </font><strong><font color = "#0099FF">@package</font></strong><font color="#009999"> WikiPlot</font><a name="a9"></a><br />9     <font color="#009999">* </font><strong><font color = "#0099FF">@subpackage</font></strong><font color="#009999"> PlotClass</font><a name="a10"></a><br />10    <font color="#009999">*/</font><a name="a11"></a><br />11    <a name="a12"></a><br />12    <font color="green">/*</font><a name="a13"></a><br />13    <font color="green">================================================================================</font><a name="a14"></a><br />14    <a name="a15"></a><br />15    <font color="green">EvalMath - PHP Class to safely evaluate math expressions</font><a name="a16"></a><br />16    <font color="green">Copyright (C) 2005 Miles Kaufmann &lt;http://www.twmagic.com/&gt;</font><a name="a17"></a><br />17    <a name="a18"></a><br />18    <font color="green">================================================================================</font><a name="a19"></a><br />19    <a name="a20"></a><br />20    <font color="green">NAME</font><a name="a21"></a><br />21    <font color="green">    EvalMath - safely evaluate math expressions</font><a name="a22"></a><br />22        <a name="a23"></a><br />23    <font color="green">SYNOPSIS</font><a name="a24"></a><br />24    <font color="green">    &lt;?</font><a name="a25"></a><br />25    <font color="green">      include('evalmath.class.php');</font><a name="a26"></a><br />26    <font color="green">      $m = new EvalMath;</font><a name="a27"></a><br />27    <font color="green">      // basic evaluation:</font><a name="a28"></a><br />28    <font color="green">      $result = $m-&gt;evaluate('2+2');</font><a name="a29"></a><br />29    <font color="green">      // supports: order of operation; parentheses; negation; built-in functions</font><a name="a30"></a><br />30    <font color="green">      $result = $m-&gt;evaluate('-8(5/2)^2*(1-sqrt(4))-8');</font><a name="a31"></a><br />31    <font color="green">      // create your own variables</font><a name="a32"></a><br />32    <font color="green">      $m-&gt;evaluate('a = e^(ln(pi))');</font><a name="a33"></a><br />33    <font color="green">      // or functions</font><a name="a34"></a><br />34    <font color="green">      $m-&gt;evaluate('f(x,y) = x^2 + y^2 - 2x*y + 1');</font><a name="a35"></a><br />35    <font color="green">      // and then use them</font><a name="a36"></a><br />36    <font color="green">      $result = $m-&gt;evaluate('3*f(42,a)');</font><a name="a37"></a><br />37    <font color="green">    ?&gt;</font><a name="a38"></a><br />38          <a name="a39"></a><br />39    <font color="green">DESCRIPTION</font><a name="a40"></a><br />40    <font color="green">    Use the EvalMath class when you want to evaluate mathematical expressions </font><a name="a41"></a><br />41    <font color="green">    from untrusted sources.  You can define your own variables and functions,</font><a name="a42"></a><br />42    <font color="green">    which are stored in the object.  Try it, it's fun!</font><a name="a43"></a><br />43    <a name="a44"></a><br />44    <font color="green">METHODS</font><a name="a45"></a><br />45    <font color="green">    $m-&gt;evaluate($expr)</font><a name="a46"></a><br />46    <font color="green">        Evaluates the expression and returns the result.  If an error occurs,</font><a name="a47"></a><br />47    <font color="green">        prints a warning and returns false.  If $expr is a function assignment,</font><a name="a48"></a><br />48    <font color="green">        returns true on success.</font><a name="a49"></a><br />49        <a name="a50"></a><br />50    <font color="green">    $m-&gt;e($expr)</font><a name="a51"></a><br />51    <font color="green">        A synonym for $m-&gt;evaluate().</font><a name="a52"></a><br />52        <a name="a53"></a><br />53    <font color="green">    $m-&gt;vars()</font><a name="a54"></a><br />54    <font color="green">        Returns an associative array of all user-defined variables and values.</font><a name="a55"></a><br />55            <a name="a56"></a><br />56    <font color="green">    $m-&gt;funcs()</font><a name="a57"></a><br />57    <font color="green">        Returns an array of all user-defined functions.</font><a name="a58"></a><br />58    <a name="a59"></a><br />59    <font color="green">PARAMETERS</font><a name="a60"></a><br />60    <font color="green">    $m-&gt;suppress_errors</font><a name="a61"></a><br />61    <font color="green">        Set to true to turn off warnings when evaluating expressions</font><a name="a62"></a><br />62    <a name="a63"></a><br />63    <font color="green">    $m-&gt;last_error</font><a name="a64"></a><br />64    <font color="green">        If the last evaluation failed, contains a string describing the error.</font><a name="a65"></a><br />65    <font color="green">        (Useful when suppress_errors is on).</font><a name="a66"></a><br />66    <a name="a67"></a><br />67    <font color="green">AUTHOR INFORMATION</font><a name="a68"></a><br />68    <font color="green">    Copyright 2005, Miles Kaufmann.</font><a name="a69"></a><br />69    <a name="a70"></a><br />70    <font color="green">LICENSE</font><a name="a71"></a><br />71    <font color="green">    Redistribution and use in source and binary forms, with or without</font><a name="a72"></a><br />72    <font color="green">    modification, are permitted provided that the following conditions are</font><a name="a73"></a><br />73    <font color="green">    met:</font><a name="a74"></a><br />74        <a name="a75"></a><br />75    <font color="green">    1   Redistributions of source code must retain the above copyright</font><a name="a76"></a><br />76    <font color="green">        notice, this list of conditions and the following disclaimer.</font><a name="a77"></a><br />77    <font color="green">    2.  Redistributions in binary form must reproduce the above copyright</font><a name="a78"></a><br />78    <font color="green">        notice, this list of conditions and the following disclaimer in the</font><a name="a79"></a><br />79    <font color="green">        documentation and/or other materials provided with the distribution.</font><a name="a80"></a><br />80    <font color="green">    3.  The name of the author may not be used to endorse or promote</font><a name="a81"></a><br />81    <font color="green">        products derived from this software without specific prior written</font><a name="a82"></a><br />82    <font color="green">        permission.</font><a name="a83"></a><br />83        <a name="a84"></a><br />84    <font color="green">    THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR</font><a name="a85"></a><br />85    <font color="green">    IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED</font><a name="a86"></a><br />86    <font color="green">    WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</font><a name="a87"></a><br />87    <font color="green">    DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT,</font><a name="a88"></a><br />88    <font color="green">    INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</font><a name="a89"></a><br />89    <font color="green">    (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</font><a name="a90"></a><br />90    <font color="green">    SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</font><a name="a91"></a><br />91    <font color="green">    HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,</font><a name="a92"></a><br />92    <font color="green">    STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN</font><a name="a93"></a><br />93    <font color="green">    ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</font><a name="a94"></a><br />94    <font color="green">    POSSIBILITY OF SUCH DAMAGE.</font><a name="a95"></a><br />95    <a name="a96"></a><br />96    <font color="green">*/</font><a name="a97"></a><br />97    <a name="a98"></a><br />98    <font color="#009999">/**</font><a name="a99"></a><br />99    <font color="#009999">* Evalution of expressions</font><a name="a100"></a><br />100   <font color="#009999">* </font><a name="a101"></a><br />101   <font color="#009999">* The class is used to evaluate mathematical expressions very safely</font><a name="a102"></a><br />102   <font color="#009999">* </font><a name="a103"></a><br />103   <font color="#009999">* </font><strong><font color = "#0099FF">@package</font></strong><font color="#009999"> WikiPlot</font><a name="a104"></a><br />104   <font color="#009999">* </font><strong><font color = "#0099FF">@subpackage</font></strong><font color="#009999"> PlotClass</font><a name="a105"></a><br />105   <font color="#009999">*/</font><a name="a106"></a><br />106   <font color="blue">class </font><a href="../WikiPlot/PlotClass/EvalMath.html">EvalMath</a> <strong>{</strong><a name="a107"></a><br />107   <a name="a108"></a><br />108       <font color="blue">var </font><a href="../WikiPlot/PlotClass/EvalMath.html#var$suppress_errors">$suppress_errors</a> = false<strong>;</strong><a name="a109"></a><br />109       <font color="blue">var </font><a href="../WikiPlot/PlotClass/EvalMath.html#var$last_error">$last_error</a> = null<strong>;</strong><a name="a110"></a><br />110       <a name="a111"></a><br />111       <font color="blue">var </font><a href="../WikiPlot/PlotClass/EvalMath.html#var$v">$v</a> = array<strong>(</strong><font color="#66cccc">'e'</font>=&gt;2.71<strong>,</strong><font color="#66cccc">'pi'</font>=&gt;3.14<strong>)</strong><strong>; </strong><font color="green">// variables (and constants)</font><a name="a111"></a><br />111       <a name="a112"></a><br />112       <font color="blue">var </font><a href="../WikiPlot/PlotClass/EvalMath.html#var$f">$f</a> = array<strong>(</strong><strong>)</strong><strong>; </strong><font color="green">// user-defined functions</font><a name="a112"></a><br />112       <a name="a113"></a><br />113       <font color="blue">var </font><a href="../WikiPlot/PlotClass/EvalMath.html#var$vb">$vb</a> = array<strong>(</strong><font color="#66cccc">'e'</font><strong>, </strong><font color="#66cccc">'pi'</font><strong>)</strong><strong>; </strong><font color="green">// constants</font><a name="a113"></a><br />113       <a name="a114"></a><br />114       <font color="blue">var </font><a href="../WikiPlot/PlotClass/EvalMath.html#var$fb">$fb</a> = array<strong>(  </strong><font color="green">// built-in functions</font><a name="a114"></a><br />114           <a name="a115"></a><br />115           <font color="#66cccc">'sin'</font><strong>,</strong><font color="#66cccc">'sinh'</font><strong>,</strong><font color="#66cccc">'arcsin'</font><strong>,</strong><font color="#66cccc">'asin'</font><strong>,</strong><font color="#66cccc">'arcsinh'</font><strong>,</strong><font color="#66cccc">'asinh'</font><strong>,</strong><a name="a116"></a><br />116           <font color="#66cccc">'cos'</font><strong>,</strong><font color="#66cccc">'cosh'</font><strong>,</strong><font color="#66cccc">'arccos'</font><strong>,</strong><font color="#66cccc">'acos'</font><strong>,</strong><font color="#66cccc">'arccosh'</font><strong>,</strong><font color="#66cccc">'acosh'</font><strong>,</strong><a name="a117"></a><br />117           <font color="#66cccc">'tan'</font><strong>,</strong><font color="#66cccc">'tanh'</font><strong>,</strong><font color="#66cccc">'arctan'</font><strong>,</strong><font color="#66cccc">'atan'</font><strong>,</strong><font color="#66cccc">'arctanh'</font><strong>,</strong><font color="#66cccc">'atanh'</font><strong>,</strong><a name="a118"></a><br />118           <font color="#66cccc">'sqrt'</font><strong>,</strong><font color="#66cccc">'abs'</font><strong>,</strong><font color="#66cccc">'ln'</font><strong>,</strong><font color="#66cccc">'log'</font><strong>)</strong><strong>;</strong><a name="a119"></a><br />119       <a name="a120"></a><br />120       <font color="blue">function </font><a href="../WikiPlot/PlotClass/EvalMath.html#methodEvalMath">EvalMath</a><strong>(</strong><strong>) </strong><strong>{</strong><a name="a121"></a><br />121           <font color="green">// make the variables a little more accurate</font><a name="a122"></a><br />122           <strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$v">v</a><strong>[</strong><font color="#66cccc">'pi'</font><strong>] </strong>= <a href="http://www.php.net/pi">pi</a><strong>(</strong><strong>)</strong><strong>;</strong><a name="a123"></a><br />123           <strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$v">v</a><strong>[</strong><font color="#66cccc">'e'</font><strong>] </strong>= <a href="http://www.php.net/exp">exp</a><strong>(</strong>1<strong>)</strong><strong>;</strong><a name="a124"></a><br />124       <strong>}</strong><a name="a125"></a><br />125       <a name="a126"></a><br />126       <font color="blue">function </font><a href="../WikiPlot/PlotClass/EvalMath.html#methode">e</a><strong>(</strong><strong>$expr</strong><strong>) </strong><strong>{</strong><a name="a127"></a><br />127           <font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodevaluate">evaluate</a><strong>(</strong><strong>$expr</strong><strong>)</strong><strong>;</strong><a name="a128"></a><br />128       <strong>}</strong><a name="a129"></a><br />129       <a name="a130"></a><br />130       <font color="blue">function </font><a href="../WikiPlot/PlotClass/EvalMath.html#methodevaluate">evaluate</a><strong>(</strong><strong>$expr</strong><strong>) </strong><strong>{</strong><a name="a131"></a><br />131           <strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$last_error">last_error</a> = null<strong>;</strong><a name="a132"></a><br />132           <strong>$expr </strong>= <a href="http://www.php.net/trim">trim</a><strong>(</strong><strong>$expr</strong><strong>)</strong><strong>;</strong><a name="a133"></a><br />133           <font color="blue">if </font><strong>(</strong><a href="http://www.php.net/substr">substr</a><strong>(</strong><strong>$expr</strong><strong>, </strong>-1<strong>, </strong>1<strong>) </strong>== <font color="#66cccc">';'</font><strong>) </strong><strong>$expr </strong>= <a href="http://www.php.net/substr">substr</a><strong>(</strong><strong>$expr</strong><strong>, </strong>0<strong>, </strong><a href="http://www.php.net/strlen">strlen</a><strong>(</strong><strong>$expr</strong><strong>)</strong>-1<strong>)</strong><strong>; </strong><font color="green">// strip semicolons at the end</font><a name="a134"></a><br />134           <font color="green">//===============</font><a name="a135"></a><br />135           <font color="green">// is it a variable assignment?</font><a name="a136"></a><br />136           <font color="blue">if </font><strong>(</strong><a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'/^\s*([a-z]\w*)\s*=\s*(.+)$/'</font><strong>, </strong><strong>$expr</strong><strong>, </strong><strong>$matches</strong><strong>)) </strong><strong>{</strong><a name="a137"></a><br />137               <font color="blue">if </font><strong>(</strong><a href="http://www.php.net/in_array">in_array</a><strong>(</strong><strong>$matches</strong><strong>[</strong>1<strong>]</strong><strong>, </strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$vb">vb</a><strong>)) </strong><strong>{ </strong><font color="green">// make sure we're not assigning to a constant</font><a name="a138"></a><br />138                   <font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><font color="#66cccc">&quot;</font><font color="#66cccc">cannot assign to constant '<strong>$matches</strong><strong>[</strong>1<strong>]</strong>'</font><font color="#66cccc">&quot;</font><strong>)</strong><strong>;</strong><a name="a139"></a><br />139               <strong>}</strong><a name="a140"></a><br />140               <font color="blue">if </font><strong>((</strong><strong>$tmp </strong>= <strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodpfx">pfx</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodnfx">nfx</a><strong>(</strong><strong>$matches</strong><strong>[</strong>2<strong>]</strong><strong>))) </strong>=== false<strong>) </strong><font color="blue">return </font>false<strong>; </strong><font color="green">// get the result and make sure it's good</font><a name="a141"></a><br />141               <strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$v">v</a><strong>[</strong><strong>$matches</strong><strong>[</strong>1<strong>]] </strong>= <strong>$tmp</strong><strong>; </strong><font color="green">// if so, stick it in the variable array</font><a name="a142"></a><br />142               <font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$v">v</a><strong>[</strong><strong>$matches</strong><strong>[</strong>1<strong>]]</strong><strong>; </strong><font color="green">// and return the resulting value</font><a name="a143"></a><br />143           <font color="green">//===============</font><a name="a144"></a><br />144           <font color="green">// is it a function assignment?</font><a name="a145"></a><br />145           <strong>} </strong>elseif <strong>(</strong><a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'/^\s*([a-z]\w*)\s*\(\s*([a-z]\w*(?:\s*,\s*[a-z]\w*)*)\s*\)\s*=\s*(.+)$/'</font><strong>, </strong><strong>$expr</strong><strong>, </strong><strong>$matches</strong><strong>)) </strong><strong>{</strong><a name="a146"></a><br />146               <strong>$fnn </strong>= <strong>$matches</strong><strong>[</strong>1<strong>]</strong><strong>; </strong><font color="green">// get the function name</font><a name="a147"></a><br />147               <font color="blue">if </font><strong>(</strong><a href="http://www.php.net/in_array">in_array</a><strong>(</strong><strong>$matches</strong><strong>[</strong>1<strong>]</strong><strong>, </strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$fb">fb</a><strong>)) </strong><strong>{ </strong><font color="green">// make sure it isn't built in</font><a name="a148"></a><br />148                   <font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><font color="#66cccc">&quot;</font><font color="#66cccc">cannot redefine built-in function '<strong>$matches</strong><strong>[</strong>1<strong>]</strong>()'</font><font color="#66cccc">&quot;</font><strong>)</strong><strong>;</strong><a name="a149"></a><br />149               <strong>}</strong><a name="a150"></a><br />150               <strong>$args </strong>= <a href="http://www.php.net/explode">explode</a><strong>(</strong><font color="#66cccc">&quot;,&quot;</font><strong>, </strong><a href="http://www.php.net/preg_replace">preg_replace</a><strong>(</strong><font color="#66cccc">&quot;/\s+/&quot;</font><strong>, </strong><font color="#66cccc">&quot;&quot;</font><strong>, </strong><strong>$matches</strong><strong>[</strong>2<strong>]</strong><strong>))</strong><strong>; </strong><font color="green">// get the arguments</font><a name="a151"></a><br />151               <font color="blue">if </font><strong>((</strong><strong>$stack </strong>= <strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodnfx">nfx</a><strong>(</strong><strong>$matches</strong><strong>[</strong>3<strong>]</strong><strong>)) </strong>=== false<strong>) </strong><font color="blue">return </font>false<strong>; </strong><font color="green">// see if it can be converted to postfix</font><a name="a152"></a><br />152               <font color="blue">for </font><strong>(</strong><strong>$i </strong>= 0<strong>; </strong><strong>$i</strong>&lt;<a href="http://www.php.net/count">count</a><strong>(</strong><strong>$stack</strong><strong>)</strong><strong>; </strong><strong>$i</strong>++<strong>) </strong><strong>{ </strong><font color="green">// freeze the state of the non-argument variables</font><a name="a153"></a><br />153                   <strong>$token </strong>= <strong>$stack</strong><strong>[</strong><strong>$i</strong><strong>]</strong><strong>;</strong><a name="a154"></a><br />154                   <font color="blue">if </font><strong>(</strong><a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'/^[a-z]\w*$/'</font><strong>, </strong><strong>$token</strong><strong>) </strong>and <strong>!</strong><a href="http://www.php.net/in_array">in_array</a><strong>(</strong><strong>$token</strong><strong>, </strong><strong>$args</strong><strong>)) </strong><strong>{</strong><a name="a155"></a><br />155                       <font color="blue">if </font><strong>(</strong><a href="http://www.php.net/array_key_exists">array_key_exists</a><strong>(</strong><strong>$token</strong><strong>, </strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$v">v</a><strong>)) </strong><strong>{</strong><a name="a156"></a><br />156                           <strong>$stack</strong><strong>[</strong><strong>$i</strong><strong>] </strong>= <strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$v">v</a><strong>[</strong><strong>$token</strong><strong>]</strong><strong>;</strong><a name="a157"></a><br />157                       <strong>} </strong>else <strong>{</strong><a name="a158"></a><br />158                           <font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><font color="#66cccc">&quot;</font><font color="#66cccc">undefined variable '<strong>$token</strong>' in function definition</font><font color="#66cccc">&quot;</font><strong>)</strong><strong>;</strong><a name="a159"></a><br />159                       <strong>}</strong><a name="a160"></a><br />160                   <strong>}</strong><a name="a161"></a><br />161               <strong>}</strong><a name="a162"></a><br />162               <strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$f">f</a><strong>[</strong><strong>$fnn</strong><strong>] </strong>= array<strong>(</strong><font color="#66cccc">'args'</font>=&gt;<strong>$args</strong><strong>, </strong><font color="#66cccc">'func'</font>=&gt;<strong>$stack</strong><strong>)</strong><strong>;</strong><a name="a163"></a><br />163               <font color="blue">return </font>true<strong>;</strong><a name="a164"></a><br />164           <font color="green">//===============</font><a name="a165"></a><br />165           <strong>} </strong>else <strong>{</strong><a name="a166"></a><br />166               <font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodpfx">pfx</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodnfx">nfx</a><strong>(</strong><strong>$expr</strong><strong>))</strong><strong>; </strong><font color="green">// straight up evaluation, woo</font><a name="a167"></a><br />167           <strong>}</strong><a name="a168"></a><br />168       <strong>}</strong><a name="a169"></a><br />169       <a name="a170"></a><br />170       <font color="blue">function </font><a href="../WikiPlot/PlotClass/EvalMath.html#methodvars">vars</a><strong>(</strong><strong>) </strong><strong>{</strong><a name="a171"></a><br />171           <strong>$output </strong>= <strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$v">v</a><strong>;</strong><a name="a172"></a><br />172           unset<strong>(</strong><strong>$output</strong><strong>[</strong><font color="#66cccc">'pi'</font><strong>]</strong><strong>)</strong><strong>;</strong><a name="a173"></a><br />173           unset<strong>(</strong><strong>$output</strong><strong>[</strong><font color="#66cccc">'e'</font><strong>]</strong><strong>)</strong><strong>;</strong><a name="a174"></a><br />174           <font color="blue">return </font><strong>$output</strong><strong>;</strong><a name="a175"></a><br />175       <strong>}</strong><a name="a176"></a><br />176       <a name="a177"></a><br />177       <font color="blue">function </font><a href="../WikiPlot/PlotClass/EvalMath.html#methodfuncs">funcs</a><strong>(</strong><strong>) </strong><strong>{</strong><a name="a178"></a><br />178           <strong>$output </strong>= array<strong>(</strong><strong>)</strong><strong>;</strong><a name="a179"></a><br />179           <font color="blue">foreach </font><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$f">f</a> as <strong>$fnn</strong>=&gt;<strong>$dat</strong><strong>)</strong><a name="a180"></a><br />180               <strong>$output</strong><strong>[</strong><strong>] </strong>= <strong>$fnn </strong>. <font color="#66cccc">'(' </font>. <a href="http://www.php.net/implode">implode</a><strong>(</strong><font color="#66cccc">','</font><strong>, </strong><strong>$dat</strong><strong>[</strong><font color="#66cccc">'args'</font><strong>]</strong><strong>) </strong>. <font color="#66cccc">')'</font><strong>;</strong><a name="a181"></a><br />181           <font color="blue">return </font><strong>$output</strong><strong>;</strong><a name="a182"></a><br />182       <strong>}</strong><a name="a183"></a><br />183   <a name="a184"></a><br />184       <font color="green">//===================== HERE BE INTERNAL METHODS ====================\\</font><a name="a185"></a><br />185   <a name="a186"></a><br />186       <font color="green">// Convert infix to postfix notation</font><a name="a186"></a><br />186       <a name="a187"></a><br />187       <font color="blue">function </font><a href="../WikiPlot/PlotClass/EvalMath.html#methodnfx">nfx</a><strong>(</strong><strong>$expr</strong><strong>) </strong><strong>{</strong><a name="a188"></a><br />188       <a name="a189"></a><br />189           <strong>$index </strong>= 0<strong>;</strong><a name="a190"></a><br />190           <strong>$stack </strong>= new <a href="../WikiPlot/PlotClass/EvalMathStack.html">EvalMathStack</a><strong>;</strong><a name="a191"></a><br />191           <strong>$output </strong>= array<strong>(</strong><strong>)</strong><strong>; </strong><font color="green">// postfix form of expression, to be passed to pfx()</font><a name="a192"></a><br />192           <strong>$expr </strong>= <a href="http://www.php.net/trim">trim</a><strong>(</strong><a href="http://www.php.net/strtolower">strtolower</a><strong>(</strong><strong>$expr</strong><strong>))</strong><strong>;</strong><a name="a193"></a><br />193           <a name="a194"></a><br />194           <strong>$ops   </strong>= array<strong>(</strong><font color="#66cccc">'+'</font><strong>, </strong><font color="#66cccc">'-'</font><strong>, </strong><font color="#66cccc">'*'</font><strong>, </strong><font color="#66cccc">'/'</font><strong>, </strong><font color="#66cccc">'^'</font><strong>, </strong><font color="#66cccc">'_'</font><strong>)</strong><strong>;</strong><a name="a195"></a><br />195           <strong>$ops_r </strong>= array<strong>(</strong><font color="#66cccc">'+'</font>=&gt;0<strong>,</strong><font color="#66cccc">'-'</font>=&gt;0<strong>,</strong><font color="#66cccc">'*'</font>=&gt;0<strong>,</strong><font color="#66cccc">'/'</font>=&gt;0<strong>,</strong><font color="#66cccc">'^'</font>=&gt;1<strong>)</strong><strong>; </strong><font color="green">// right-associative operator?  </font><a name="a196"></a><br />196           <strong>$ops_p </strong>= array<strong>(</strong><font color="#66cccc">'+'</font>=&gt;0<strong>,</strong><font color="#66cccc">'-'</font>=&gt;0<strong>,</strong><font color="#66cccc">'*'</font>=&gt;1<strong>,</strong><font color="#66cccc">'/'</font>=&gt;1<strong>,</strong><font color="#66cccc">'_'</font>=&gt;1<strong>,</strong><font color="#66cccc">'^'</font>=&gt;2<strong>)</strong><strong>; </strong><font color="green">// operator precedence</font><a name="a197"></a><br />197           <a name="a198"></a><br />198           <strong>$expecting_op </strong>= false<strong>; </strong><font color="green">// we use this in syntax-checking the expression</font><a name="a199"></a><br />199                                  <font color="green">// and determining when a - is a negation</font><a name="a200"></a><br />200       <a name="a201"></a><br />201           <font color="blue">if </font><strong>(</strong><a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">&quot;/[^\w\s+*^\/()\.,-]/&quot;</font><strong>, </strong><strong>$expr</strong><strong>, </strong><strong>$matches</strong><strong>)) </strong><strong>{ </strong><font color="green">// make sure the characters are all good</font><a name="a202"></a><br />202               <font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><font color="#66cccc">&quot;</font><font color="#66cccc">illegal character '{<strong>$matches</strong><strong>[</strong>0<strong>]</strong><strong>}</strong>'</font><font color="#66cccc">&quot;</font><strong>)</strong><strong>;</strong><a name="a203"></a><br />203           <strong>}</strong><a name="a204"></a><br />204       <a name="a205"></a><br />205           while<strong>(</strong>1<strong>) </strong><strong>{ </strong><font color="green">// 1 Infinite Loop ;)</font><a name="a206"></a><br />206               <strong>$op </strong>= <a href="http://www.php.net/substr">substr</a><strong>(</strong><strong>$expr</strong><strong>, </strong><strong>$index</strong><strong>, </strong>1<strong>)</strong><strong>; </strong><font color="green">// get the first character at the current index</font><a name="a207"></a><br />207               <font color="green">// find out if we're currently at the beginning of a number/variable/function/parenthesis/operand</font><a name="a208"></a><br />208               <strong>$ex </strong>= <a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">'/^([a-z]\w*\(?|\d+(?:\.\d*)?|\.\d+|\()/'</font><strong>, </strong><a href="http://www.php.net/substr">substr</a><strong>(</strong><strong>$expr</strong><strong>, </strong><strong>$index</strong><strong>)</strong><strong>, </strong><strong>$match</strong><strong>)</strong><strong>;</strong><a name="a209"></a><br />209               <font color="green">//===============</font><a name="a210"></a><br />210               <font color="blue">if </font><strong>(</strong><strong>$op </strong>== <font color="#66cccc">'-' </font>and <strong>!</strong><strong>$expecting_op</strong><strong>) </strong><strong>{ </strong><font color="green">// is it a negation instead of a minus?</font><a name="a211"></a><br />211                   <strong>$stack</strong><strong>-&gt;</strong>push<strong>(</strong><font color="#66cccc">'_'</font><strong>)</strong><strong>; </strong><font color="green">// put a negation on the stack</font><a name="a212"></a><br />212                   <strong>$index</strong>++<strong>;</strong><a name="a213"></a><br />213               <strong>} </strong>elseif <strong>(</strong><strong>$op </strong>== <font color="#66cccc">'_'</font><strong>) </strong><strong>{ </strong><font color="green">// we have to explicitly deny this, because it's legal on the stack </font><a name="a214"></a><br />214                   <font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><font color="#66cccc">&quot;illegal character '_'&quot;</font><strong>)</strong><strong>; </strong><font color="green">// but not in the input expression</font><a name="a215"></a><br />215               <font color="green">//===============</font><a name="a216"></a><br />216               <strong>} </strong>elseif <strong>((</strong><a href="http://www.php.net/in_array">in_array</a><strong>(</strong><strong>$op</strong><strong>, </strong><strong>$ops</strong><strong>) </strong>or <strong>$ex</strong><strong>) </strong>and <strong>$expecting_op</strong><strong>) </strong><strong>{ </strong><font color="green">// are we putting an operator on the stack?</font><a name="a217"></a><br />217                   <font color="blue">if </font><strong>(</strong><strong>$ex</strong><strong>) </strong><strong>{ </strong><font color="green">// are we expecting an operator but have a number/variable/function/opening parethesis?</font><a name="a218"></a><br />218                       <strong>$op </strong>= <font color="#66cccc">'*'</font><strong>; </strong><strong>$index</strong>--<strong>; </strong><font color="green">// it's an implicit multiplication</font><a name="a219"></a><br />219                   <strong>}</strong><a name="a220"></a><br />220                   <font color="green">// heart of the algorithm:</font><a name="a221"></a><br />221                   while<strong>(</strong><strong>$stack</strong><strong>-&gt;</strong>count &gt; 0 and <strong>(</strong><strong>$o2 </strong>= <strong>$stack</strong><strong>-&gt;</strong>last<strong>(</strong><strong>)) </strong>and <a href="http://www.php.net/in_array">in_array</a><strong>(</strong><strong>$o2</strong><strong>, </strong><strong>$ops</strong><strong>) </strong>and <strong>(</strong><strong>$ops_r</strong><strong>[</strong><strong>$op</strong><strong>] </strong>? <strong>$ops_p</strong><strong>[</strong><strong>$op</strong><strong>] </strong>&lt; <strong>$ops_p</strong><strong>[</strong><strong>$o2</strong><strong>] </strong>: <strong>$ops_p</strong><strong>[</strong><strong>$op</strong><strong>] </strong>&lt;= <strong>$ops_p</strong><strong>[</strong><strong>$o2</strong><strong>]</strong><strong>)) </strong><strong>{</strong><a name="a222"></a><br />222                       <strong>$output</strong><strong>[</strong><strong>] </strong>= <strong>$stack</strong><strong>-&gt;</strong>pop<strong>(</strong><strong>)</strong><strong>; </strong><font color="green">// pop stuff off the stack into the output</font><a name="a223"></a><br />223                   <strong>}</strong><a name="a224"></a><br />224                   <font color="green">// many thanks: http://en.wikipedia.org/wiki/Reverse_Polish_notation#The_algorithm_in_detail</font><a name="a225"></a><br />225                   <strong>$stack</strong><strong>-&gt;</strong>push<strong>(</strong><strong>$op</strong><strong>)</strong><strong>; </strong><font color="green">// finally put OUR operator onto the stack</font><a name="a226"></a><br />226                   <strong>$index</strong>++<strong>;</strong><a name="a227"></a><br />227                   <strong>$expecting_op </strong>= false<strong>;</strong><a name="a228"></a><br />228               <font color="green">//===============</font><a name="a229"></a><br />229               <strong>} </strong>elseif <strong>(</strong><strong>$op </strong>== <font color="#66cccc">')' </font>and <strong>$expecting_op</strong><strong>) </strong><strong>{ </strong><font color="green">// ready to close a parenthesis?</font><a name="a230"></a><br />230                   while <strong>((</strong><strong>$o2 </strong>= <strong>$stack</strong><strong>-&gt;</strong>pop<strong>(</strong><strong>)) </strong>!= <font color="#66cccc">'('</font><strong>) </strong><strong>{ </strong><font color="green">// pop off the stack back to the last (</font><a name="a231"></a><br />231                       <font color="blue">if </font><strong>(</strong><a href="http://www.php.net/is_null">is_null</a><strong>(</strong><strong>$o2</strong><strong>)) </strong><font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><font color="#66cccc">&quot;unexpected ')'&quot;</font><strong>)</strong><strong>;</strong><a name="a232"></a><br />232                       else <strong>$output</strong><strong>[</strong><strong>] </strong>= <strong>$o2</strong><strong>;</strong><a name="a233"></a><br />233                   <strong>}</strong><a name="a234"></a><br />234                   <font color="blue">if </font><strong>(</strong><a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">&quot;</font><font color="#66cccc">/^(<strong>[</strong>a-z<strong>]</strong>\w*)\($/</font><font color="#66cccc">&quot;</font><strong>, </strong><strong>$stack</strong><strong>-&gt;</strong>last<strong>(</strong>2<strong>)</strong><strong>, </strong><strong>$matches</strong><strong>)) </strong><strong>{ </strong><font color="green">// did we just close a function?</font><a name="a235"></a><br />235                       <strong>$fnn </strong>= <strong>$matches</strong><strong>[</strong>1<strong>]</strong><strong>; </strong><font color="green">// get the function name</font><a name="a236"></a><br />236                       <strong>$arg_count </strong>= <strong>$stack</strong><strong>-&gt;</strong>pop<strong>(</strong><strong>)</strong><strong>; </strong><font color="green">// see how many arguments there were (cleverly stored on the stack, thank you)</font><a name="a237"></a><br />237                       <strong>$output</strong><strong>[</strong><strong>] </strong>= <strong>$stack</strong><strong>-&gt;</strong>pop<strong>(</strong><strong>)</strong><strong>; </strong><font color="green">// pop the function and push onto the output</font><a name="a238"></a><br />238                       <font color="blue">if </font><strong>(</strong><a href="http://www.php.net/in_array">in_array</a><strong>(</strong><strong>$fnn</strong><strong>, </strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$fb">fb</a><strong>)) </strong><strong>{ </strong><font color="green">// check the argument count</font><a name="a239"></a><br />239                           <font color="blue">if</font><strong>(</strong><strong>$arg_count </strong>&gt; 1<strong>)</strong><a name="a240"></a><br />240                               <font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><font color="#66cccc">&quot;</font><font color="#66cccc">too many arguments (<strong>$arg_count</strong> given, 1 expected)</font><font color="#66cccc">&quot;</font><strong>)</strong><strong>;</strong><a name="a241"></a><br />241                       <strong>} </strong>elseif <strong>(</strong><a href="http://www.php.net/array_key_exists">array_key_exists</a><strong>(</strong><strong>$fnn</strong><strong>, </strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$f">f</a><strong>)) </strong><strong>{</strong><a name="a242"></a><br />242                           <font color="blue">if </font><strong>(</strong><strong>$arg_count </strong>!= <a href="http://www.php.net/count">count</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$f">f</a><strong>[</strong><strong>$fnn</strong><strong>]</strong><strong>[</strong><font color="#66cccc">'args'</font><strong>]</strong><strong>))</strong><a name="a243"></a><br />243                               <font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><font color="#66cccc">&quot;</font><font color="#66cccc">wrong number of arguments (<strong>$arg_count</strong> given, </font><font color="#66cccc">&quot; </font>. <a href="http://www.php.net/count">count</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$f">f</a><strong>[</strong><strong>$fnn</strong><strong>]</strong><strong>[</strong><font color="#66cccc">'args'</font><strong>]</strong><strong>) </strong>. <font color="#66cccc">&quot; expected)&quot;</font><strong>)</strong><strong>;</strong><a name="a244"></a><br />244                       <strong>} </strong>else <strong>{ </strong><font color="green">// did we somehow push a non-function on the stack? this should never happen</font><a name="a245"></a><br />245                           <font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><font color="#66cccc">&quot;internal error&quot;</font><strong>)</strong><strong>;</strong><a name="a246"></a><br />246                       <strong>}</strong><a name="a247"></a><br />247                   <strong>}</strong><a name="a248"></a><br />248                   <strong>$index</strong>++<strong>;</strong><a name="a249"></a><br />249               <font color="green">//===============</font><a name="a250"></a><br />250               <strong>} </strong>elseif <strong>(</strong><strong>$op </strong>== <font color="#66cccc">',' </font>and <strong>$expecting_op</strong><strong>) </strong><strong>{ </strong><font color="green">// did we just finish a function argument?</font><a name="a251"></a><br />251                   while <strong>((</strong><strong>$o2 </strong>= <strong>$stack</strong><strong>-&gt;</strong>pop<strong>(</strong><strong>)) </strong>!= <font color="#66cccc">'('</font><strong>) </strong><strong>{ </strong><a name="a252"></a><br />252                       <font color="blue">if </font><strong>(</strong><a href="http://www.php.net/is_null">is_null</a><strong>(</strong><strong>$o2</strong><strong>)) </strong><font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><font color="#66cccc">&quot;unexpected ','&quot;</font><strong>)</strong><strong>; </strong><font color="green">// oops, never had a (</font><a name="a253"></a><br />253                       else <strong>$output</strong><strong>[</strong><strong>] </strong>= <strong>$o2</strong><strong>; </strong><font color="green">// pop the argument expression stuff and push onto the output</font><a name="a254"></a><br />254                   <strong>}</strong><a name="a255"></a><br />255                   <font color="green">// make sure there was a function</font><a name="a256"></a><br />256                   <font color="blue">if </font><strong>(</strong><strong>!</strong><a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">&quot;</font><font color="#66cccc">/^(<strong>[</strong>a-z<strong>]</strong>\w*)\($/</font><font color="#66cccc">&quot;</font><strong>, </strong><strong>$stack</strong><strong>-&gt;</strong>last<strong>(</strong>2<strong>)</strong><strong>, </strong><strong>$matches</strong><strong>))</strong><a name="a257"></a><br />257                       <font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><font color="#66cccc">&quot;unexpected ','&quot;</font><strong>)</strong><strong>;</strong><a name="a258"></a><br />258                   <strong>$stack</strong><strong>-&gt;</strong>push<strong>(</strong><strong>$stack</strong><strong>-&gt;</strong>pop<strong>(</strong><strong>)</strong>+1<strong>)</strong><strong>; </strong><font color="green">// increment the argument count</font><a name="a259"></a><br />259                   <strong>$stack</strong><strong>-&gt;</strong>push<strong>(</strong><font color="#66cccc">'('</font><strong>)</strong><strong>; </strong><font color="green">// put the ( back on, we'll need to pop back to it again</font><a name="a260"></a><br />260                   <strong>$index</strong>++<strong>;</strong><a name="a261"></a><br />261                   <strong>$expecting_op </strong>= false<strong>;</strong><a name="a262"></a><br />262               <font color="green">//===============</font><a name="a263"></a><br />263               <strong>} </strong>elseif <strong>(</strong><strong>$op </strong>== <font color="#66cccc">'(' </font>and <strong>!</strong><strong>$expecting_op</strong><strong>) </strong><strong>{</strong><a name="a264"></a><br />264                   <strong>$stack</strong><strong>-&gt;</strong>push<strong>(</strong><font color="#66cccc">'('</font><strong>)</strong><strong>; </strong><font color="green">// that was easy</font><a name="a265"></a><br />265                   <strong>$index</strong>++<strong>;</strong><a name="a266"></a><br />266                   <strong>$allow_neg </strong>= true<strong>;</strong><a name="a267"></a><br />267               <font color="green">//===============</font><a name="a268"></a><br />268               <strong>} </strong>elseif <strong>(</strong><strong>$ex </strong>and <strong>!</strong><strong>$expecting_op</strong><strong>) </strong><strong>{ </strong><font color="green">// do we now have a function/variable/number?</font><a name="a269"></a><br />269                   <strong>$expecting_op </strong>= true<strong>;</strong><a name="a270"></a><br />270                   <strong>$val </strong>= <strong>$match</strong><strong>[</strong>1<strong>]</strong><strong>;</strong><a name="a271"></a><br />271                   <font color="blue">if </font><strong>(</strong><a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">&quot;</font><font color="#66cccc">/^(<strong>[</strong>a-z<strong>]</strong>\w*)\($/</font><font color="#66cccc">&quot;</font><strong>, </strong><strong>$val</strong><strong>, </strong><strong>$matches</strong><strong>)) </strong><strong>{ </strong><font color="green">// may be func, or variable w/ implicit multiplication against parentheses...</font><a name="a272"></a><br />272                       <font color="blue">if </font><strong>(</strong><a href="http://www.php.net/in_array">in_array</a><strong>(</strong><strong>$matches</strong><strong>[</strong>1<strong>]</strong><strong>, </strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$fb">fb</a><strong>) </strong>or <a href="http://www.php.net/array_key_exists">array_key_exists</a><strong>(</strong><strong>$matches</strong><strong>[</strong>1<strong>]</strong><strong>, </strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$f">f</a><strong>)) </strong><strong>{ </strong><font color="green">// it's a func</font><a name="a273"></a><br />273                           <strong>$stack</strong><strong>-&gt;</strong>push<strong>(</strong><strong>$val</strong><strong>)</strong><strong>;</strong><a name="a274"></a><br />274                           <strong>$stack</strong><strong>-&gt;</strong>push<strong>(</strong>1<strong>)</strong><strong>;</strong><a name="a275"></a><br />275                           <strong>$stack</strong><strong>-&gt;</strong>push<strong>(</strong><font color="#66cccc">'('</font><strong>)</strong><strong>;</strong><a name="a276"></a><br />276                           <strong>$expecting_op </strong>= false<strong>;</strong><a name="a277"></a><br />277                       <strong>} </strong>else <strong>{ </strong><font color="green">// it's a var w/ implicit multiplication</font><a name="a278"></a><br />278                           <strong>$val </strong>= <strong>$matches</strong><strong>[</strong>1<strong>]</strong><strong>;</strong><a name="a279"></a><br />279                           <strong>$output</strong><strong>[</strong><strong>] </strong>= <strong>$val</strong><strong>;</strong><a name="a280"></a><br />280                       <strong>}</strong><a name="a281"></a><br />281                   <strong>} </strong>else <strong>{ </strong><font color="green">// it's a plain old var or num</font><a name="a282"></a><br />282                       <strong>$output</strong><strong>[</strong><strong>] </strong>= <strong>$val</strong><strong>;</strong><a name="a283"></a><br />283                   <strong>}</strong><a name="a284"></a><br />284                   <strong>$index </strong>+= <a href="http://www.php.net/strlen">strlen</a><strong>(</strong><strong>$val</strong><strong>)</strong><strong>;</strong><a name="a285"></a><br />285               <font color="green">//===============</font><a name="a286"></a><br />286               <strong>} </strong>elseif <strong>(</strong><strong>$op </strong>== <font color="#66cccc">')'</font><strong>) </strong><strong>{ </strong><font color="green">// miscellaneous error checking</font><a name="a287"></a><br />287                   <font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><font color="#66cccc">&quot;unexpected ')'&quot;</font><strong>)</strong><strong>;</strong><a name="a288"></a><br />288               <strong>} </strong>elseif <strong>(</strong><a href="http://www.php.net/in_array">in_array</a><strong>(</strong><strong>$op</strong><strong>, </strong><strong>$ops</strong><strong>) </strong>and <strong>!</strong><strong>$expecting_op</strong><strong>) </strong><strong>{</strong><a name="a289"></a><br />289                   <font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><font color="#66cccc">&quot;</font><font color="#66cccc">unexpected operator '<strong>$op</strong>'</font><font color="#66cccc">&quot;</font><strong>)</strong><strong>;</strong><a name="a290"></a><br />290               <strong>} </strong>else <strong>{ </strong><font color="green">// I don't even want to know what you did to get here</font><a name="a291"></a><br />291                   <font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><font color="#66cccc">&quot;an unexpected error occured&quot;</font><strong>)</strong><strong>;</strong><a name="a292"></a><br />292               <strong>}</strong><a name="a293"></a><br />293               <font color="blue">if </font><strong>(</strong><strong>$index </strong>== <a href="http://www.php.net/strlen">strlen</a><strong>(</strong><strong>$expr</strong><strong>)) </strong><strong>{</strong><a name="a294"></a><br />294                   <font color="blue">if </font><strong>(</strong><a href="http://www.php.net/in_array">in_array</a><strong>(</strong><strong>$op</strong><strong>, </strong><strong>$ops</strong><strong>)) </strong><strong>{ </strong><font color="green">// did we end with an operator? bad.</font><a name="a295"></a><br />295                       <font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><font color="#66cccc">&quot;</font><font color="#66cccc">operator '<strong>$op</strong>' lacks operand</font><font color="#66cccc">&quot;</font><strong>)</strong><strong>;</strong><a name="a296"></a><br />296                   <strong>} </strong>else <strong>{</strong><a name="a297"></a><br />297                       break<strong>;</strong><a name="a298"></a><br />298                   <strong>}</strong><a name="a299"></a><br />299               <strong>}</strong><a name="a300"></a><br />300               while <strong>(</strong><a href="http://www.php.net/substr">substr</a><strong>(</strong><strong>$expr</strong><strong>, </strong><strong>$index</strong><strong>, </strong>1<strong>) </strong>== <font color="#66cccc">' '</font><strong>) </strong><strong>{ </strong><font color="green">// step the index past whitespace (pretty much turns whitespace </font><a name="a301"></a><br />301                   <strong>$index</strong>++<strong>;                             </strong><font color="green">// into implicit multiplication if no operator is there)</font><a name="a302"></a><br />302               <strong>}</strong><a name="a303"></a><br />303           <a name="a304"></a><br />304           <strong>} </strong><a name="a305"></a><br />305           while <strong>(</strong><strong>!</strong><a href="http://www.php.net/is_null">is_null</a><strong>(</strong><strong>$op </strong>= <strong>$stack</strong><strong>-&gt;</strong>pop<strong>(</strong><strong>))) </strong><strong>{ </strong><font color="green">// pop everything off the stack and push onto output</font><a name="a306"></a><br />306               <font color="blue">if </font><strong>(</strong><strong>$op </strong>== <font color="#66cccc">'('</font><strong>) </strong><font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><font color="#66cccc">&quot;expecting ')'&quot;</font><strong>)</strong><strong>; </strong><font color="green">// if there are (s on the stack, ()s were unbalanced</font><a name="a307"></a><br />307               <strong>$output</strong><strong>[</strong><strong>] </strong>= <strong>$op</strong><strong>;</strong><a name="a308"></a><br />308           <strong>}</strong><a name="a309"></a><br />309           <font color="blue">return </font><strong>$output</strong><strong>;</strong><a name="a310"></a><br />310       <strong>}</strong><a name="a311"></a><br />311   <a name="a312"></a><br />312       <font color="green">// evaluate postfix notation</font><a name="a312"></a><br />312       <a name="a313"></a><br />313       <font color="blue">function </font><a href="../WikiPlot/PlotClass/EvalMath.html#methodpfx">pfx</a><strong>(</strong><strong>$tokens</strong><strong>, </strong><strong>$vars </strong>= array<strong>(</strong><strong>)) </strong><strong>{</strong><a name="a314"></a><br />314           <a name="a315"></a><br />315           <font color="blue">if </font><strong>(</strong><strong>$tokens </strong>== false<strong>) </strong><font color="blue">return </font>false<strong>;</strong><a name="a316"></a><br />316       <a name="a317"></a><br />317           <strong>$stack </strong>= new <a href="../WikiPlot/PlotClass/EvalMathStack.html">EvalMathStack</a><strong>;</strong><a name="a318"></a><br />318           <a name="a319"></a><br />319           <font color="blue">foreach </font><strong>(</strong><strong>$tokens </strong>as <strong>$token</strong><strong>) </strong><strong>{ </strong><font color="green">// nice and easy</font><a name="a320"></a><br />320               <font color="green">// if the token is a binary operator, pop two values off the stack, do the operation, and push the result back on</font><a name="a321"></a><br />321               <font color="blue">if </font><strong>(</strong><a href="http://www.php.net/in_array">in_array</a><strong>(</strong><strong>$token</strong><strong>, </strong>array<strong>(</strong><font color="#66cccc">'+'</font><strong>, </strong><font color="#66cccc">'-'</font><strong>, </strong><font color="#66cccc">'*'</font><strong>, </strong><font color="#66cccc">'/'</font><strong>, </strong><font color="#66cccc">'^'</font><strong>))) </strong><strong>{</strong><a name="a322"></a><br />322                   <font color="blue">if </font><strong>(</strong><a href="http://www.php.net/is_null">is_null</a><strong>(</strong><strong>$op2 </strong>= <strong>$stack</strong><strong>-&gt;</strong>pop<strong>(</strong><strong>))) </strong><font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><font color="#66cccc">&quot;internal error&quot;</font><strong>)</strong><strong>;</strong><a name="a323"></a><br />323                   <font color="blue">if </font><strong>(</strong><a href="http://www.php.net/is_null">is_null</a><strong>(</strong><strong>$op1 </strong>= <strong>$stack</strong><strong>-&gt;</strong>pop<strong>(</strong><strong>))) </strong><font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><font color="#66cccc">&quot;internal error&quot;</font><strong>)</strong><strong>;</strong><a name="a324"></a><br />324                   <font color="blue">switch </font><strong>(</strong><strong>$token</strong><strong>) </strong><strong>{</strong><a name="a325"></a><br />325                       case <font color="#66cccc">'+'</font>:<a name="a326"></a><br />326                           <strong>$stack</strong><strong>-&gt;</strong>push<strong>(</strong><strong>$op1</strong>+<strong>$op2</strong><strong>)</strong><strong>; </strong>break<strong>;</strong><a name="a327"></a><br />327                       case <font color="#66cccc">'-'</font>:<a name="a328"></a><br />328                           <strong>$stack</strong><strong>-&gt;</strong>push<strong>(</strong><strong>$op1</strong>-<strong>$op2</strong><strong>)</strong><strong>; </strong>break<strong>;</strong><a name="a329"></a><br />329                       case <font color="#66cccc">'*'</font>:<a name="a330"></a><br />330                           <strong>$stack</strong><strong>-&gt;</strong>push<strong>(</strong><strong>$op1</strong>*<strong>$op2</strong><strong>)</strong><strong>; </strong>break<strong>;</strong><a name="a331"></a><br />331                       case <font color="#66cccc">'/'</font>:<a name="a332"></a><br />332                           <font color="blue">if </font><strong>(</strong><strong>$op2 </strong>== 0<strong>) </strong><font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><font color="#66cccc">&quot;division by zero&quot;</font><strong>)</strong><strong>;</strong><a name="a333"></a><br />333                           <strong>$stack</strong><strong>-&gt;</strong>push<strong>(</strong><strong>$op1</strong>/<strong>$op2</strong><strong>)</strong><strong>; </strong>break<strong>;</strong><a name="a334"></a><br />334                       case <font color="#66cccc">'^'</font>:<a name="a335"></a><br />335                           <strong>$stack</strong><strong>-&gt;</strong>push<strong>(</strong><a href="http://www.php.net/pow">pow</a><strong>(</strong><strong>$op1</strong><strong>, </strong><strong>$op2</strong><strong>))</strong><strong>; </strong>break<strong>;</strong><a name="a336"></a><br />336                   <strong>}</strong><a name="a337"></a><br />337               <font color="green">// if the token is a unary operator, pop one value off the stack, do the operation, and push it back on</font><a name="a338"></a><br />338               <strong>} </strong>elseif <strong>(</strong><strong>$token </strong>== <font color="#66cccc">&quot;_&quot;</font><strong>) </strong><strong>{</strong><a name="a339"></a><br />339                   <strong>$stack</strong><strong>-&gt;</strong>push<strong>(</strong>-1*<strong>$stack</strong><strong>-&gt;</strong>pop<strong>(</strong><strong>))</strong><strong>;</strong><a name="a340"></a><br />340               <font color="green">// if the token is a function, pop arguments off the stack, hand them to the function, and push the result back on</font><a name="a341"></a><br />341               <strong>} </strong>elseif <strong>(</strong><a href="http://www.php.net/preg_match">preg_match</a><strong>(</strong><font color="#66cccc">&quot;</font><font color="#66cccc">/^(<strong>[</strong>a-z<strong>]</strong>\w*)\($/</font><font color="#66cccc">&quot;</font><strong>, </strong><strong>$token</strong><strong>, </strong><strong>$matches</strong><strong>)) </strong><strong>{ </strong><font color="green">// it's a function!</font><a name="a342"></a><br />342                   <strong>$fnn </strong>= <strong>$matches</strong><strong>[</strong>1<strong>]</strong><strong>;</strong><a name="a343"></a><br />343                   <font color="blue">if </font><strong>(</strong><a href="http://www.php.net/in_array">in_array</a><strong>(</strong><strong>$fnn</strong><strong>, </strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$fb">fb</a><strong>)) </strong><strong>{ </strong><font color="green">// built-in function:</font><a name="a344"></a><br />344                       <font color="blue">if </font><strong>(</strong><a href="http://www.php.net/is_null">is_null</a><strong>(</strong><strong>$op1 </strong>= <strong>$stack</strong><strong>-&gt;</strong>pop<strong>(</strong><strong>))) </strong><font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><font color="#66cccc">&quot;internal error&quot;</font><strong>)</strong><strong>;</strong><a name="a345"></a><br />345                       <strong>$fnn </strong>= <a href="http://www.php.net/preg_replace">preg_replace</a><strong>(</strong><font color="#66cccc">&quot;/^arc/&quot;</font><strong>, </strong><font color="#66cccc">&quot;a&quot;</font><strong>, </strong><strong>$fnn</strong><strong>)</strong><strong>; </strong><font color="green">// for the 'arc' trig synonyms</font><a name="a346"></a><br />346                       <font color="blue">if </font><strong>(</strong><strong>$fnn </strong>== <font color="#66cccc">'ln'</font><strong>) </strong><strong>$fnn </strong>= <font color="#66cccc">'log'</font><strong>;</strong><a name="a347"></a><br />347                       eval<strong>(</strong><font color="#66cccc">'$stack-&gt;push(' </font>. <strong>$fnn </strong>. <font color="#66cccc">'($op1));'</font><strong>)</strong><strong>; </strong><font color="green">// perfectly safe eval()</font><a name="a348"></a><br />348                   <strong>} </strong>elseif <strong>(</strong><a href="http://www.php.net/array_key_exists">array_key_exists</a><strong>(</strong><strong>$fnn</strong><strong>, </strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$f">f</a><strong>)) </strong><strong>{ </strong><font color="green">// user function</font><a name="a349"></a><br />349                       <font color="green">// get args</font><a name="a350"></a><br />350                       <strong>$args </strong>= array<strong>(</strong><strong>)</strong><strong>;</strong><a name="a351"></a><br />351                       <font color="blue">for </font><strong>(</strong><strong>$i </strong>= <a href="http://www.php.net/count">count</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$f">f</a><strong>[</strong><strong>$fnn</strong><strong>]</strong><strong>[</strong><font color="#66cccc">'args'</font><strong>]</strong><strong>)</strong>-1<strong>; </strong><strong>$i </strong>&gt;= 0<strong>; </strong><strong>$i</strong>--<strong>) </strong><strong>{</strong><a name="a352"></a><br />352                           <font color="blue">if </font><strong>(</strong><a href="http://www.php.net/is_null">is_null</a><strong>(</strong><strong>$args</strong><strong>[</strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$f">f</a><strong>[</strong><strong>$fnn</strong><strong>]</strong><strong>[</strong><font color="#66cccc">'args'</font><strong>]</strong><strong>[</strong><strong>$i</strong><strong>]] </strong>= <strong>$stack</strong><strong>-&gt;</strong>pop<strong>(</strong><strong>))) </strong><font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><font color="#66cccc">&quot;internal error&quot;</font><strong>)</strong><strong>;</strong><a name="a353"></a><br />353                       <strong>}</strong><a name="a354"></a><br />354                       <strong>$stack</strong><strong>-&gt;</strong>push<strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodpfx">pfx</a><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$f">f</a><strong>[</strong><strong>$fnn</strong><strong>]</strong><strong>[</strong><font color="#66cccc">'func'</font><strong>]</strong><strong>, </strong><strong>$args</strong><strong>))</strong><strong>; </strong><font color="green">// yay... recursion!!!!</font><a name="a355"></a><br />355                   <strong>}</strong><a name="a356"></a><br />356               <font color="green">// if the token is a number or variable, push it on the stack</font><a name="a357"></a><br />357               <strong>} </strong>else <strong>{</strong><a name="a358"></a><br />358                   <font color="blue">if </font><strong>(</strong><a href="http://www.php.net/is_numeric">is_numeric</a><strong>(</strong><strong>$token</strong><strong>)) </strong><strong>{</strong><a name="a359"></a><br />359                       <strong>$stack</strong><strong>-&gt;</strong>push<strong>(</strong><strong>$token</strong><strong>)</strong><strong>;</strong><a name="a360"></a><br />360                   <strong>} </strong>elseif <strong>(</strong><a href="http://www.php.net/array_key_exists">array_key_exists</a><strong>(</strong><strong>$token</strong><strong>, </strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$v">v</a><strong>)) </strong><strong>{</strong><a name="a361"></a><br />361                       <strong>$stack</strong><strong>-&gt;</strong>push<strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$v">v</a><strong>[</strong><strong>$token</strong><strong>]</strong><strong>)</strong><strong>;</strong><a name="a362"></a><br />362                   <strong>} </strong>elseif <strong>(</strong><a href="http://www.php.net/array_key_exists">array_key_exists</a><strong>(</strong><strong>$token</strong><strong>, </strong><strong>$vars</strong><strong>)) </strong><strong>{</strong><a name="a363"></a><br />363                       <strong>$stack</strong><strong>-&gt;</strong>push<strong>(</strong><strong>$vars</strong><strong>[</strong><strong>$token</strong><strong>]</strong><strong>)</strong><strong>;</strong><a name="a364"></a><br />364                   <strong>} </strong>else <strong>{</strong><a name="a365"></a><br />365                       <font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><font color="#66cccc">&quot;</font><font color="#66cccc">undefined variable '<strong>$token</strong>'</font><font color="#66cccc">&quot;</font><strong>)</strong><strong>;</strong><a name="a366"></a><br />366                   <strong>}</strong><a name="a367"></a><br />367               <strong>}</strong><a name="a368"></a><br />368           <strong>}</strong><a name="a369"></a><br />369           <font color="green">// when we're out of tokens, the stack should have a single element, the final result</font><a name="a370"></a><br />370           <font color="blue">if </font><strong>(</strong><strong>$stack</strong><strong>-&gt;</strong>count != 1<strong>) </strong><font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><font color="#66cccc">&quot;internal error&quot;</font><strong>)</strong><strong>;</strong><a name="a371"></a><br />371           <font color="blue">return </font><strong>$stack</strong><strong>-&gt;</strong>pop<strong>(</strong><strong>)</strong><strong>;</strong><a name="a372"></a><br />372       <strong>}</strong><a name="a373"></a><br />373       <a name="a374"></a><br />374       <font color="green">// trigger an error, but nicely, if need be</font><a name="a374"></a><br />374       <a name="a375"></a><br />375       <font color="blue">function </font><a href="../WikiPlot/PlotClass/EvalMath.html#methodtrigger">trigger</a><strong>(</strong><strong>$msg</strong><strong>) </strong><strong>{</strong><a name="a376"></a><br />376           <strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$last_error">last_error</a> = <strong>$msg</strong><strong>;</strong><a name="a377"></a><br />377           <font color="blue">if </font><strong>(</strong><strong>!</strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMath.html#var$suppress_errors">suppress_errors</a><strong>) </strong><a href="http://www.php.net/trigger_error">trigger_error</a><strong>(</strong><strong>$msg</strong><strong>, </strong>E_USER_WARNING<strong>)</strong><strong>;</strong><a name="a378"></a><br />378           <font color="blue">return </font>false<strong>;</strong><a name="a379"></a><br />379       <strong>}</strong><a name="a380"></a><br />380   <strong>}</strong><a name="a381"></a><br />381   <a name="a382"></a><br />382   <font color="green">// for internal use</font><a name="a383"></a><br />383   <a name="a384"></a><br />384   <font color="#009999">/**</font><a name="a385"></a><br />385   <font color="#009999">* Required by EvalMath class</font><a name="a386"></a><br />386   <font color="#009999">* </font><a name="a387"></a><br />387   <font color="#009999">* The class is used by EvalMath class internally</font><a name="a388"></a><br />388   <font color="#009999">* </font><a name="a389"></a><br />389   <font color="#009999">* </font><strong><font color = "#0099FF">@package</font></strong><font color="#009999"> WikiPlot</font><a name="a390"></a><br />390   <font color="#009999">* </font><strong><font color = "#0099FF">@subpackage</font></strong><font color="#009999"> PlotClass</font><a name="a391"></a><br />391   <font color="#009999">*/</font><a name="a392"></a><br />392   <font color="blue">class </font><a href="../WikiPlot/PlotClass/EvalMathStack.html">EvalMathStack</a> <strong>{</strong><a name="a393"></a><br />393   <a name="a394"></a><br />394       <font color="blue">var </font><a href="../WikiPlot/PlotClass/EvalMathStack.html#var$stack">$stack</a> = array<strong>(</strong><strong>)</strong><strong>;</strong><a name="a395"></a><br />395       <font color="blue">var </font><a href="../WikiPlot/PlotClass/EvalMathStack.html#var$count">$count</a> = 0<strong>;</strong><a name="a396"></a><br />396       <a name="a397"></a><br />397       <font color="blue">function </font><a href="../WikiPlot/PlotClass/EvalMathStack.html#methodpush">push</a><strong>(</strong><strong>$val</strong><strong>) </strong><strong>{</strong><a name="a398"></a><br />398           <strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMathStack.html#var$stack">stack</a><strong>[</strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMathStack.html#var$count">count</a><strong>] </strong>= <strong>$val</strong><strong>;</strong><a name="a399"></a><br />399           <strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMathStack.html#var$count">count</a>++<strong>;</strong><a name="a400"></a><br />400       <strong>}</strong><a name="a401"></a><br />401       <a name="a402"></a><br />402       <font color="blue">function </font><a href="../WikiPlot/PlotClass/EvalMathStack.html#methodpop">pop</a><strong>(</strong><strong>) </strong><strong>{</strong><a name="a403"></a><br />403           <font color="blue">if </font><strong>(</strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMathStack.html#var$count">count</a> &gt; 0<strong>) </strong><strong>{</strong><a name="a404"></a><br />404               <strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMathStack.html#var$count">count</a>--<strong>;</strong><a name="a405"></a><br />405               <font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMathStack.html#var$stack">stack</a><strong>[</strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMathStack.html#var$count">count</a><strong>]</strong><strong>;</strong><a name="a406"></a><br />406           <strong>}</strong><a name="a407"></a><br />407           <font color="blue">return </font>null<strong>;</strong><a name="a408"></a><br />408       <strong>}</strong><a name="a409"></a><br />409       <a name="a410"></a><br />410       <font color="blue">function </font><a href="../WikiPlot/PlotClass/EvalMathStack.html#methodlast">last</a><strong>(</strong><strong>$n</strong>=1<strong>) </strong><strong>{</strong><a name="a411"></a><br />411           <font color="blue">return </font><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMathStack.html#var$stack">stack</a><strong>[</strong><strong>$this</strong><strong>-&gt;</strong><a href="../WikiPlot/PlotClass/EvalMathStack.html#var$count">count</a>-<strong>$n</strong><strong>]</strong><strong>;</strong><a name="a412"></a><br />412       <strong>}</strong><a name="a413"></a><br />413   <strong>}</strong></pre>
	<div id="credit">
		<hr>
		Documentation generated on Fri, 13 Oct 2006 06:44:29 +0200 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.3.0RC3</a>
	</div>
</body>
</html>